# Template file for 'stumpwm'
pkgname=stumpwm
# WARNING !!! WARHNING !!! WARNING !!!
#
# This package MUST be rebuilt for EVERY SBCL update because compiled FASL
# files (and thus the executable) are ONLY compatible with specific versions.
#
version=24.11
revision=1
makedepends="autoconf sbcl cl-ppcre cl-alexandria cl-clx texinfo"
depends="sbcl>=2.4.2_1 cl-ppcre cl-alexandria cl-clx"
checkdepends="sbcl cl-fiasco"
short_desc="Stump Window Manager"
maintainer="Mihail Ivanchev <contact@ivanchev.net>"
license="GPL-2.0-only"
homepage="https://github.com/stumpwm/stumpwm"
distfiles="https://github.com/stumpwm/stumpwm/archive/refs/tags/${version}.tar.gz"
checksum=1f2a5edf30dc8897234845514ea927478645cf8fb6b05b9ba7fe7a898720e08d
nostrip=yes

export SBCL_HOME=/usr/lib/sbcl

do_configure() {
	./autogen.sh
	./configure --prefix="${DESTDIR}/usr" --with-module-dir=/usr/share/stumpwm/contrib
}

do_build() {
	make
}

do_check() {
	make test
}

do_install() {
	make install
}
